! .***(((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((*.!
!.(((((((((((((((((((((((/////****/////((((((((((((((((((((((((((((((((((((((((!
!((((((((((((((((((/*,,,...,,,,************//((((((((((((((((((((((((((((((((((!
!((((((((((((((/*.....**//((((((((((((((((////*//((((((((((((((((((((((((((((((!
!(((((((((((((/,.  .,///((((((((((((((((((((//////(((((((((((((((((((((((((((((!
!((((((((((//,  ,**/(((((((((((((((((((((((((((((//((((((((((((((((((((((((((((!
!(((((((((/,,  ,*//((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((!
!(((((((/*.  .*/(((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((!
!((((((/*. ,,/(((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((!
!((((((/. .**/(((((((((((((///////(((((///////////////////////////////(((((((((!
!((((//,  *//(((((((((((((/,     .**/(/..             ,.            ...*/((((((!
!((((**. ,/((((((((((((((/*.      ..*(/..   .,,,,,,,,**,    .,,,,,..    .,//(((!
!(((/,,  ,/((((((((((((((/,    .    *//..   ,**////////,    .*/////*..   .**/((!
!(((/,, .*((((((((((((((/*    ,*.   .**..   ,//(((((((/,    ./((((((//,   ..*((!
!(((/.. .*((((((((((((((*.  ..*/*.   .*,,    ......**//,    ./((((((((*.    ,/(!
!(((/.. .*((((((((((((//,   ,,/(/.   .,,,          ,,//,    ./((((((((*.    ,/(!
!(((/,, .*/((((((((((/**.   ,,***,    .,,.  .******//(/,    ./((((((//*.  ..*/(!
!(((/**. ,/((((((((((*..               ..,. ,//(((((((/,    ./(((((/**.   ,,/((!
!((((**. .*(((((((((/,     .........   ..,,.,//////////,    .*/////*..   .**/((!
!((((//*  ,//((((((/*.   .*/((((((//,    .,.         .,.               .,/(((((!
!((((((/,  ,,/(((((/,....*/(((((((((/,....,*,........,*,...........,**//(((((((!
!(((((((*. ..*/((((//***//(((((((((((//**////********////********/////(((((((((!
!((((((((/,   ,/(((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((((!
!(((((((((/**. .,//((((((((((((((((((((((((((((((//((((((((((((((((((((((((((((!
!((((((((((//*. .,,//(((((((((((((((((((((((((((///((((((((((((((((((((((((((((!
!(((((((((((((//,.. .,**/((((((((((((((((((//////((((((((((((((((((((((((((((((!
!(((((((((((((((/**,....,*////((((((((/////**///(((((((((((((((((((((((((((((((!
!(((((((((((((((((((//**,,....,,,,,,,,***///(((((((((((((((((((((((((((((((((((!
!.((((((((((((((((((((((((((////////((((((((((((((((((((((((((((((((((((((((**.!
!###############################################################################
!
! solution_method     (1: Euler's Method)
! link_bottom_drag    (T/F: AED variables included/excluded in TFV bottom drag)
! link_surface_drag   (T/F: AED variables included/excluded in TFV surface drag)
! link_water_density  (T/F: AED variables included/excluded in TFV density calculation)
! link_water_clarity  (T/F: AED variables included/excluded in TFV light extinction)
! base_par_extinction (Kw; /m)
! ext_tss_extinction  (T/F: TFV SS concs included/excluded in Kd calculation)
!
&aed_bio
   !-- AED2 configuration flags
   solution_method =  1
   do_limiter      = .true.
   display_minmax  = .false.
 ! do_2d_atm_flux  = .true.
 ! do_particle_bgc = .false.
   glob_min = -1e38
   glob_max =  1e38
   min_water_depth =  0.0401
   n_equil_substep = 12
   !-- Linkages with host model: PHYSICS
   link_bottom_drag = .false.
   link_surface_drag = .false.
   link_water_density = .false.
   !-- Linkages with host model: LIGHT
   link_ext_par = .false.
   link_water_clarity = .false.
   base_par_extinction = 0.2
   ext_tss_extinction = .false.
   tss_par_extinction = 0.02
   !-- Linkages with host model: RIPARIAN
   link_solar_shade = .false.
   link_rain_loss = .false.
   !-- Benthic variable initialisation
   init_values_file = ''
   route_table_file = '../External/AED/Routing_Tbl.csv'
/

!-------------------------------------------------------------------------------
! aed_models  :  List of AED2 modules to be simulated
!-------------------------------------------------------------------------------
!
! List here the available aed modules to be included in the simulation.
!       It is important they are listed in the correct order so dependencies
!       can be set during the model set-up phase.
!
! For further detail about available AED modules visit:
!       http://aquatic.science.uwa.edu.au/research/models/AED/
!
! NOTE: This example only includes CORE modules without all values and options
!       configured. Refer to the web-links for summary tables of modules
!       parameters, and  refer to AED2+ documentation for details of
!       configuration of the PLUS modules.
!
!-------------------------------------------------------------------------------
&aed_models
    models =
       !-->  NUTRIENT/CHEMISTRY modules  <--!
             'aed_sedflux',
             'aed_macrophyte',
			       'aed_noncohesive',
             'aed_tracer',
             'aed_oxygen',
        !off 'aed_carbon',
             'aed_silica',
             'aed_nitrogen',
             'aed_phosphorus',
             'aed_organic_matter',
        !off 'aed_seddiagenesis',
       !-->  BIOLOGY modules  <--!
             'aed_phytoplankton',
             'aed_macroalgae',
        !off 'aed_geochemistry',
        !off 'aed_zooplankton',
        !off 'aed_bivalve',
        !off 'aed_macrophyte',
        !off 'aed_pathogens',
       !-->  RIPARIAN modules  <--!
        !off 'aed_land',
        !off 'aed_ass',
        !off 'aed_vegetation',
       !-->  SUMMARY modules  <--!
             'aed_totals',
             'aed_habitat'
/

!###############################################################################
! SDF: aed_sedflux - AED sedflux interface module
!
! If TFV is host, this allows spatially variable fluxes, based on Materials
!
!-------------------------------------------------------------------------------
&aed_sedflux
   sedflux_model = 'Constant2D'
/
&aed_sed_const2d
 n_zones = 5    ! check match to TFV material zones
 Fsed_oxy =    -15.,-20.,-50.,-30.,-50.
 Fsed_rsi =    -1e10,-1e10,-1e10,-1e10,-1e10
 Fsed_amm =     0.2,0.5,1.2,0.5,1.9
 Fsed_nit =     1.,1.,3.,1.,2.
 Fsed_frp =     0.05,0.15,0.16,0.12,0.22
 !> disable these
 Fsed_pon =    -1e10,-1e10,-1e10,-1e10,-1e10
 Fsed_don =    -1e10,-1e10,-1e10,-1e10,-1e10
 Fsed_pop =    -1e10,-1e10,-1e10,-1e10,-1e10
 Fsed_dop =    -1e10,-1e10,-1e10,-1e10,-1e10
 Fsed_poc =    -1e10,-1e10,-1e10,-1e10,-1e10
 Fsed_doc =    -1e10,-1e10,-1e10,-1e10,-1e10
 Fsed_dic =    -1e10,-1e10,-1e10,-1e10,-1e10
/

!-------------------------------------------------------------------------------
!###############################################################################
! aed_macrophyte - AED macrophyte model
!-------------------------------------------------------------------------------
&aed_macrophyte
   num_mphy = 1
   the_mphy = 3
   n_zones  = 4
   active_zones = 2,3,4,5
   simStaticBiomass = .true.
   simMacFeedback = .false.
   dbase = '../External/AED/aed_macrophyte_pars.nml'
/

!###############################################################################
! TRC: aed_noncohesive
!
! Refer to the below link for module settings & parameter details:
! http://aquatic.science.uwa.edu.au/research/models/AED/aed_tracer.html
!
!-------------------------------------------------------------------------------
&aed_noncohesive
   !-- Select SS groups and their properties
    num_ss     = 1
    ss_initial = 1,1
    Ke_ss      = 0.06,0.063
   !-- Configure sediment resuspension
    settling   = 1
    w_ss       = -0.5,-0.05
    d_ss       = 2e-6,1e-5
    rho_ss     = 1.5e3,1.8e3
   !-- Configure sediment resuspension
    resuspension        = 2
    epsilon             = 0.0080
    tau_0               = 0.045
    tau_r               = 1.0
    Ktau_0              = 0.0015
    macrophyte_link_var = ''
   !-- Configure sediment mass
    simSedimentMass     = .true.
    fs                  = 0.4,0.4
    sed_porosity        = 0.6
/

!###############################################################################
! TRC: aed_tracer
!
! Refer to the below link for module settings & parameter details:
! http://aquatic.science.uwa.edu.au/research/models/AED/aed_tracer.html
!
!-------------------------------------------------------------------------------
&aed_tracer
   !-- Optional retention time tracer
    retention_time = .true.
   !-- Select number of tracers and their decay/sedflux/light properties
    num_tracers = 0
    decay = 0,0
    Fsed = 0,0
/

!###############################################################################
! OXY: aed_oxygen - AED oxygen model
!
! Refer to the below link for module settings & parameter details:
! http://aquatic.science.uwa.edu.au/research/models/AED/aed_oxygen.html
!
!-------------------------------------------------------------------------------
&aed_oxygen
   oxy_initial       = 225.0
   Fsed_oxy          = -40.0
   Ksed_oxy          = 100.0
   theta_sed_oxy     =   1.08
   Fsed_oxy_variable = 'SDF_Fsed_oxy'
   oxy_min           = 0
   oxy_max           = 500
  !diag_level        = 1
/

!###############################################################################
! CAR: aed_carbon - AED carbon model
!
! Refer to the below link for module settings & parameter details:
! http://aquatic.science.uwa.edu.au/research/models/AED/aed_nutrient.html
!
!-------------------------------------------------------------------------------
&aed_carbon
   !-- DIC & pH
    dic_initial = 1600.5
    Fsed_dic = 14.0
    Ksed_dic = 20.0
    theta_sed_dic = 1.08
   !Fsed_dic_variable='Fsed_dic'
    pH_initial = 7.5
    atmco2 = 390e-6
    co2_model = 1
    alk_mode = 1
    ionic = 0.1
    co2_piston_model = 1
   !-- CH4
    ch4_initial = 27.6
    Rch4ox = 0.01
    Kch4ox = 0.5
    vTch4ox = 1.08
    Fsed_ch4 = 0.5
    Ksed_ch4 = 100.0
    theta_sed_ch4 = 1.08
    methane_reactant_variable = 'OXY_oxy'
   !Fsed_ch4_variable = 'Fsed_ch4'
    atm_ch4 = 1.76e-6    !atm
    ch4_piston_model = 1
/

!###############################################################################
! SIL: aed_silica
!
! Refer to the below link for module settings & parameter details:
! http://aquatic.science.uwa.edu.au/research/models/AED/aed_nutrient.html
!
!-------------------------------------------------------------------------------
&aed_silica
   rsi_initial = 12.5
   Fsed_rsi = 0.
   Ksed_rsi = 50.0
   theta_sed_rsi = 1.08
   silica_reactant_variable='OXY_oxy'
  !Fsed_rsi_variable = 'SDF_Fsed_rsi'
/

!###############################################################################
! NIT: aed_nitrogen - AED nitrogen model
!
! Refer to the below link for module settings & parameter details:
! http://aquatic.science.uwa.edu.au/research/models/AED/aed_nutrient.html
!
!-------------------------------------------------------------------------------
&aed_nitrogen
  !-- Initial values
   amm_initial      = 12.7
   nit_initial      = 23.5
   n2o_initial      = 23.5
  !-- Nitrification
   Rnitrif          =  0.1
   Knitrif          = 78.1
   theta_nitrif     =  1.08
   nitrif_reactant_variable = 'OXY_oxy'
   simNitrfpH       = .false.
   nitrif_ph_variable = ''
   Rnh4o2           = 0.000001
   Rno2o2           = 0.000001
  !-- N2O reactions
   simN2O           = 0
   Rn2o             = 0.05
   Kpart_ammox      = 1.0
   Kin_deamm        = 1.0
   atm_n2o          = 0.32e-6     ! atm
   n2o_piston_model = 4
  !-- Annamox
   Rnh4no2          = 0.000001
   Ranammox         = 0.001
   Kanmx_nit        = 2.0
   Kanmx_amm        = 2.0
  !-- De-nitrification
   Rdenit           = 0.26
   Kdenit           = 2.0
   theta_denit      = 1.08
   Rdnra            = 0.01
   Kdnra_oxy        = 2.0
  !-- Sediment fluxes
   Fsed_amm         =   3.5
   Ksed_amm         =  25.0
   Fsed_nit         =  -4.5
   Ksed_nit         = 100.0
   Fsed_n2o         =   0.0
   Ksed_n2o         = 100.0
   theta_sed_amm    = 1.08
   theta_sed_nit    = 1.08
   Fsed_amm_variable='SDF_Fsed_amm'
   Fsed_nit_variable='SDF_Fsed_nit'
  !Fsed_n2o_variable='SDF_Fsed_n2o'
  !-- Atmospheric deposition
   simDryDeposition = .false.
   atm_din_dd       = 0.05
   simWetDeposition = .true.
   atm_din_conc     = 4.0
/

!###############################################################################
! PHS: aed_phosphorus - AED phosphorus model
!
! Refer to the below link for module settings & parameter details:
! http://aquatic.science.uwa.edu.au/research/models/AED/aed_nutrient.html
!
!-------------------------------------------------------------------------------
&aed_phosphorus
  !-- Initial value
   frp_initial = 0.29
  !-- Sediment flux
   Fsed_frp = 0.08
   Ksed_frp = 80.0
   theta_sed_frp = 1.08
   phosphorus_reactant_variable ='OXY_oxy'
   Fsed_frp_variable ='SDF_Fsed_frp'
  !-- PO4 adsorption
   simPO4Adsorption = .true.
   ads_use_external_tss = .false.
   po4sorption_target_variable ='NCS_ss1'
   PO4AdsorptionModel = 1
   Kpo4p = 0.1
   ads_use_pH = .false.
   Kadsratio= 1.0
   Qmax = 1.0
   w_po4ads = -9999     ! Note: -9999 links PO4-ad settling to target_variable
  !-- Atmospheric deposition
   simDryDeposition = .false.
   atm_pip_dd = 0.00
   simWetDeposition = .true.
   atm_frp_conc = 0.00
/


!###############################################################################
! OGM: aed_organic_matter - AED organic matter model
!
! Refer to the below link for module settings & parameter details:
! http://aquatic.science.uwa.edu.au/research/models/AED/aed_organic_matter.html
!
!-------------------------------------------------------------------------------
&aed_organic_matter
   !-- Initial concentrations for OM variables (mmol/m3)
     poc_initial  =  78.5
     doc_initial  =  39.9
     pon_initial  =   8.3
     don_initial  =   1.3
     pop_initial  =   8.3
     dop_initial  =   1.5
     docr_initial = 350.0
     donr_initial =  13.0
     dopr_initial =   3.0
     cpom_initial = 100.0
   !-- Breakdown and mineralisation (basic pool)
     Rpoc_hydrol  =   0.05
     Rdoc_minerl  =   0.001
     Rpon_hydrol  =   0.05
     Rdon_minerl  =   0.005
     Rpop_hydrol  =   0.05
     Rdop_minerl  =   0.001
     theta_hydrol =   1.08
     theta_minerl =   1.08
     Kpom_hydrol  =  31.25
     Kdom_minerl  =  31.25
     simDenitrification = 1
     dom_miner_oxy_reactant_var = 'OXY_oxy'
    !dom_miner_no2_reactant_var = 'NIT_no2'
    !dom_miner_n2o_reactant_var = 'NIT_n2o'
    !dom_miner_fe3_reactant_var = 'GEO_feiii'
    !dom_miner_so4_reactant_var = 'GEO_so4'
    !dom_miner_ch4_reactant_var = 'CAR_ch4'
     doc_miner_product_variable = ''
     don_miner_product_variable = 'NIT_amm'
     dop_miner_product_variable = 'PHS_frp'
     dom_miner_nit_reactant_var = 'NIT_nit'
     f_an = 1.
     K_nit               = 10.0
    !Kin_denitrat        = 20.0
    !Kin_denitrit        =  0.297
    !Kin_denitrous       =  0.205
    !Klim_denitrit       =  1
    !Klim_denitrous      =  1
    !Kpart_denitrit      =  1
   !-- Refractory organic matter (optional)
     simRPools    = .false.
     Rdomr_minerl = 0.0001
     Rcpom_bdown  = 0.0001
     X_cpom_n     = 0.0005
     X_cpom_p     = 0.0001
   !-- Light related parameters
     KeDOM         = 0.000005
     KePOM         = 0.00096
     KeDOMR        = 0.10000    ! = 1 (assuming KeDOMR is applied to CDOM in /m)
     KeCPOM        = 0.00096    ! = 0.08 (/m)/(mg/L)  /83.3  (mmol/m3)/(mg/L)
     simphotolysis = .false.    ! .true.
    !photo_fmin
     photo_c       = 0.75
   !-- Particle settling parameters
     settling     =  3
     w_pom        = -0.06
     d_pom        =  1e-5
     rho_pom      = 1.2e3
     w_cpom       = -0.01
     d_cpom       =  1e-5
     rho_cpom     = 1.4e3
   !-- Sediment interaction parameters (basic model)
     resuspension = 0
     resus_link   = 'NCS_resus'
     sedimentOMfrac = 0.0002
     Xsc = 0.5
     Xsn = 0.05
     Xsp = 0.005
     Fsed_doc = 0.0
     Fsed_don = 0.0
     Fsed_dop = 0.0
     Ksed_dom = 4.5
     theta_sed_dom = 1.08
    !Fsed_doc_variable = 'SDF_Fsed_doc'
    !Fsed_don_variable = 'SDF_Fsed_don'
    !Fsed_dop_variable = 'SDF_Fsed_dop'
   !-- Other options
    extra_diag = .false. !.true.
   !diag_level = 1
/


!-------------------------------------------------------------------------------
!###############################################################################
! aed_organic_matter - AED organic matter model
!-------------------------------------------------------------------------------
! pom_initial     [float, unit = mmol/m^3]
!                   initial PON conc (can be overwritten by GLM or TFV IC)
! dom_initial     [float, unit = mmol/m^3]
!                   initial DON conc (can be overwritten by GLM or TFV IC)
! w_pom           [float, unit = m/day]
!                   settling rate of detrital N pool
! Rpom_miner      [float, unit = /day ]
!                   hydrolysis/breakdown rate of detrital N pool @ 20C
! Rdom_miner      [float, unit = /day ]
!                   mineralisation rate of DON pool @ 20C
! Fsed_pom        [float, unit = mmol/m^2/day]
!                   sediment PON flux (note this is extra to sedimentation)
! Fsed_dom        [float, unit = mmol/m^2/day]
!                   sediment DON flux
! Kpom_miner      [float, unit = mmol/m^3 ]
!                   half-saturation oxygen concentration for PON breakdown
! Kdom_miner      [float, unit = mmol/m^3 ]
!                   half-saturation oxygen concentration for DON mineralisation
! Ksed_dom        [float, unit = mmol/m^3]
!                   half-saturation oxygen concentration controlling DON flux
! theta_pom_miner [float, unit = - ]
!                   Arrhenius temperature multiplier for PON breakdown
! theta_dom_miner [float, unit = - ]
!                   Arrhenius temperature multiplier for DON mineralisation
! theta_sed_dom   [float, unit = - ]
!                   Arrhenius temperature multiplier for sediment DON flux
! dom_miner_product_variable   [string]
!                   state variable to be product of DON mineralisation
! KeDOM           [float, unit = /m /(mmol C/m^3)]
!                   specific light attenuation coefificent for DOM
! KePOM           [float, unit = /m /(mmol C/m^3)]
!                   specific light attenuation coefificent for POM
! doc_miner_reactant_variable  [string]
!                   state variable to be linked to rate of DOC mineralisation
!
! NOTE: Generic use of POM/DOM in the above descriptions, use C/N/P below
!
! NOTE: Processes such as phyto or zoop excretion within any other
!       AED modules should be configured to use the following names:
!        aed_organic_matter_doc    aed_organic_matter_poc
!        aed_organic_matter_don    aed_organic_matter_pon
!        aed_organic_matter_dop    aed_organic_matter_pop
!
! DIAGNOSTICS:
!        -
!
!-------------------------------------------------------------------------------
!&aed_organic_matter
!   !-- Initial concentrations for OM variables (mmol/m3)
!          poc_initial  = 78.5
!          doc_initial  = 39.9
!          pon_initial  = 8.3
!          don_initial  = 1.3
!          pop_initial  = 8.3
!          dop_initial  = 1.5
!          docr_initial = 350.00
!          donr_initial = 13.0
!          dopr_initial = 3.0
!          cpom_initial = 100.00
!   !-- Breakdown and mineralisation (basic pool)
!          Rpoc_hydrol  = 0.05
!          Rdoc_minerl  = 0.001
!          Rpon_hydrol  = 0.05
!          Rdon_minerl  = 0.005
!          Rpop_hydrol  = 0.05
!          Rdop_minerl  = 0.001
!          theta_hydrol = 1.08
!          theta_minerl = 1.08
!          Kpom_hydrol  = 31.25
!          Kdom_minerl  = 31.25
!		  simDenitrification = 1 !BB
!          doc_miner_reactant_variable='OXY_oxy'
!          doc_miner_product_variable=''
!          don_miner_product_variable='NIT_amm'
!          dop_miner_product_variable='PHS_frp'
!          !-- Refractory organic matter (optional)
!          simRPools    = .false.
!          Rdocr_miner  = 0.0001
!          Rdonr_miner  = 0.0001
!          Rdopr_miner  = 0.0001
!          Rcpom_bdown  = 0.0001
!          X_cpom_n     = 0.0005
!          X_cpom_p     = 0.0001
!          !-- Light related parameters
!          KeDOM        = 0.000005
!          KePOM        = 0.00096
!          KeDOMR       = 0.10000    ! = 1 (assuming KeDOMR is applied to CDOM in /m)
!          KeCPOM       = 0.00096    ! = 0.08 (/m)/(mg/L)  /83.3  (mmol/m3)/(mg/L)
!          simphotolysis = .false. !.true.
!          !photo_fmin
!          photo_c      = 0.75
!          !-- Particle settling parameters
!          settling     = 3
!          w_pom        = -0.06
!          d_pom        = 2e-6
!          rho_pom      = 1.12e3
!          w_cpom       = -0.01
!          d_cpom       = 1e-5
!          rho_cpom     = 1.3e3
!          !-- Sediment interaction parameters (basic model)
!          resuspension = 1
!          resus_link   = 'TRC_resus'
!          sedimentOMfrac = 0.5
!          Xsc = 0.5
!          Xsn = 0.05
!          Xsp = 0.005
!          Fsed_doc = 2.0
!          Fsed_don = 1.0
!          Fsed_dop = 0.020
!		       Fsed_doc_variable = 'SDF_Fsed_doc'
!     Fsed_don_variable = 'SDF_Fsed_don'
!     Fsed_dop_variable = 'SDF_Fsed_dop'
!         !Fsed_doc_variable,
!         !Fsed_dop_variable,
!         !Fsed_don_variable,
!          Ksed_dom = 4.5
!          theta_sed_dom = 1.08
!          !-- Other options
!          extra_diag = .false. !.true.
!          !poc_min, poc_max, doc_min, doc_max
!          !pon_min, pon_max, don_min, don_max
!          !pop_min, pop_max, dop_min, dop_max
!		  !-- Other options
!/
!OGM from CEWH
&aed_organic_matter
   !-- Initial concentrations for OM variables (mmol/m3)
     poc_initial  =  78.5
     doc_initial  =  39.9
     pon_initial  =   8.3
     don_initial  =   1.3
     pop_initial  =   8.3
     dop_initial  =   1.5
     docr_initial = 350.0
     donr_initial =  13.0
     dopr_initial =   3.0
     cpom_initial = 100.0
   !-- Breakdown and mineralisation (basic pool)
     Rpoc_hydrol  =   0.04
     Rdoc_minerl  =   0.001
     Rpon_hydrol  =   0.05
     Rdon_minerl  =   0.005
     Rpop_hydrol  =   0.03
     Rdop_minerl  =   0.001
     theta_hydrol =   1.08
     theta_minerl =   1.08
     Kpom_hydrol  =  31.25
     Kdom_minerl  =  31.25
     simDenitrification = 1
     dom_miner_oxy_reactant_var = 'OXY_oxy'
   ! dom_miner_no2_reactant_var = 'NIT_no2'
   ! dom_miner_n2o_reactant_var = 'NIT_n2o'
   ! dom_miner_fe3_reactant_var = 'GEO_feiii'
   ! dom_miner_so4_reactant_var = 'GEO_so4'
   ! dom_miner_ch4_reactant_var = 'CAR_ch4'
     doc_miner_product_variable = ''
     don_miner_product_variable = 'NIT_amm'
     dop_miner_product_variable = 'PHS_frp'
     dom_miner_nit_reactant_var = 'NIT_nit'
     f_an = 1.
     K_nit               = 10.0
   ! Kin_denitrat        = 20.0
   ! Kin_denitrit        = 0.297
   ! Kin_denitrous       = 0.205
   ! Klim_denitrit       = 1
   ! Klim_denitrous      = 1
   ! Kpart_denitrit      = 1

   !-- Refractory organic matter (optional)
     simRPools    = .false.
     Rdomr_minerl = 0.0001
     Rcpom_bdown  = 0.0001
     X_cpom_n     = 0.0005
     X_cpom_p     = 0.0001

    !-- Light related parameters
     KeDOM         = 0.000005
     KePOM         = 0.00096
     KeDOMR        = 0.10000    ! = 1 (assuming KeDOMR is applied to CDOM in /m)
     KeCPOM        = 0.00096    ! = 0.08 (/m)/(mg/L)  /83.3  (mmol/m3)/(mg/L)
     simphotolysis = .false.    ! .true.
    !photo_fmin
     photo_c       = 0.75

    !-- Particle settling parameters
     settling     =  1
     w_pom        = -0.06
     d_pom        =  1e-5
     rho_pom      = 1.2e3
     w_cpom       = -0.01
     d_cpom       =  1e-5
     rho_cpom     = 1.4e3

    !-- Sediment interaction parameters (basic model)
     resuspension = 1
     resus_link   = 'TRC_resus'
     sedimentOMfrac = 0.0002
     Xsc = 0.5
     Xsn = 0.05
     Xsp = 0.005
     Fsed_doc = 0.0
     Fsed_don = 0.0
     Fsed_dop = 0.0
     Ksed_dom = 4.5
     theta_sed_dom = 1.08
     !Fsed_doc_variable = 'SDF_Fsed_doc'
     !Fsed_don_variable = 'SDF_Fsed_don'
     !Fsed_dop_variable = 'SDF_Fsed_dop'

     !-- Other options
      extra_diag = .true. !.true.
/


!-------------------------------------------------------------------------------
!###############################################################################
! aed_phytoplankton - AED phytoplankton model
!-------------------------------------------------------------------------------
! num_phytos      [integer]
!                   number of phytoplankton groups within this module to include
! num_phytos      [integer]
!                   list of ID's of groups in aed_phyto_pars.nml (len=num_phyto)
! X_excretion_target_variable  [string]
!                   state variable to receive C, N or P from excretion
! X_mortality_target_variable  [string]
!                   state variable to receive C, N or P from mortality
! X_uptake_target_variable  [string]
!                   state variable to be linked for C,N,P,Si or O2 uptake
!
! NOTE: Users must supply a valid "aed_phyto_pars.nml" file
!
!
! NOTE: Processes such as zoop grazing or turbidity calc within any other
!       AED modules should be configured to use the following names:
!        aed_phytoplankton_name        (where name is as defined in the nml)
!        aed_phytoplankton_name_IN     (internal nitrogen)
!        aed_phytoplankton_name_IP     (internal phosphorus)
!
! DIAGNOSTICS:
!        aed_phytoplankton_name_fI     (light limitation)
!        aed_phytoplankton_name_fT     (temp limitation)
!        aed_phytoplankton_name_fS     (salinity limitation)
!        aed_phytoplankton_name_fN     (nitrogen limitation)
!        aed_phytoplankton_name_fP     (phosphorus limitation)
!        aed_phytoplankton_name_fSi    (silica limitation)
!        aed_phytoplankton_tchla       (total module chlorophyll-a)
!        aed_phytoplankton_gpp         (total module gross primary productivity)
!
!-------------------------------------------------------------------------------
&aed_phytoplankton
!-- Configure phytoplankton groups to simulate
  num_phytos = 1
  the_phytos = 1
  settling =   1
!-- Benthic phytoplankton group (microphytobenthos)
  do_mpb = 1
  R_mpbg = 0.5
  R_mpbr = 0.05
  I_Kmpb = 100.
  mpb_max = 2000.
  resuspension = 0.45
  resus_link   = 'NCS_resus'
  n_zones = 4
  active_zones = 2,3,4,5
!-- Set link variables to other modules
  p_excretion_target_variable='OGM_dop'
  n_excretion_target_variable='OGM_don'
  c_excretion_target_variable='OGM_doc'
  si_excretion_target_variable=''
  p_mortality_target_variable='OGM_pop'
  n_mortality_target_variable='OGM_pon'
  c_mortality_target_variable='OGM_poc'
  si_mortality_target_variable=''
  p1_uptake_target_variable='PHS_frp'
  n1_uptake_target_variable='NIT_nit'
  n2_uptake_target_variable='NIT_amm'
  si_uptake_target_variable='SIL_rsi'
  do_uptake_target_variable='OXY_oxy'
  c_uptake_target_variable=''
!-- General options
  dbase = '../External/AED/aed_phyto_pars.nml'
  extra_diag = .true.
 !zerolimitfudgefactor = ??
  min_rho = 900.
  max_rho = 1200.
/

&aed_macroalgae
   num_malgae = 1
   the_malgae = 1
   settling =   5
   slough_stress = 0.5
   n_zones = 5
   active_zones = 1,2,3,4,5
   p_excretion_target_variable='OGM_dop'
   n_excretion_target_variable='OGM_don'
   c_excretion_target_variable='OGM_doc'
   si_excretion_target_variable='SIL_rsi'
   p_mortality_target_variable='OGM_pop'
   n_mortality_target_variable='OGM_pon'
   c_mortality_target_variable='OGM_poc'
   si_mortality_target_variable=''
   p1_uptake_target_variable='PHS_frp'
   n1_uptake_target_variable='NIT_nit'
   n2_uptake_target_variable='NIT_amm'
   si_uptake_target_variable='SIL_rsi'
   do_uptake_target_variable='OXY_oxy'
   c_uptake_target_variable=''
   simMalgHSI = 1
   extra_debug = .true.
   dbase = '../External/AED/aed_malgae_pars.nml'
/

!-------------------------------------------------------------------------------
!###############################################################################
! aed_zooplankton - AED zooplankton model
!-------------------------------------------------------------------------------
! num_zoops      [integer]
!                   number of zooplankton groups within this module to include
! the_zoops      [integer]
!                   list of ID's of groups in aed_zoop_pars.nml (len=num_zoops)
! dX_target_variable  [string]
!                   state variable linked to provide/receive dissoved OM
! pX_target_variable  [string]
!                   state variable linked to provide/receive particulate OM
!
! NOTE: Users must supply a valid "aed_zoops_pars.nml" file
!
!
! NOTE: Processes such as zoop grazing or turbidity calc within any other
!       AED modules should be configured to use the following names:
!        aed_zooplankton_name        (where name is as defined in the nml)
!
! DIAGNOSTICS:
!       -
!
!-------------------------------------------------------------------------------
&aed_zooplankton
   num_zoops = 1
   the_zoops = 1
   dn_target_variable='OGM_don'  ! dissolved nitrogen target variable
   pn_target_variable='OGM_pon'  ! particulate nitrogen target variable
   dp_target_variable='OGM_dop'  ! dissolved phosphorus target variable
   pp_target_variable='OGM_pop'  ! particulate phosphorus target variable
   dc_target_variable='OGM_doc'  ! dissolved carbon target variable
   pc_target_variable='OGM_poc'  ! particulate carbon target variable
/



!-------------------------------------------------------------------------------
! aed_geochemistry
!-------------------------------------------------------------------------------
! speciation_dt     [integer]
!                     number of timesteps between calculations
! geochem_file      [string]
!                     data file with thermodynamic info for speciation calculations
! num_components    [integer]
!                     number of dissolved 'components' to be considered
! dis_components    [string]
!                     list of component names (must match those in the geochem_file)
! component_link    [string]
!                     name of any active variabiles to be used as a component (if present, else '')
! Fsed_gch          [float]
!                     sediment flux rate of dissolved components (mol/m2/day)
! num_mineral       [integer]
!                     number of particulate mineral phases to be included
! the_minerals      [string]
!                     list of mineral names (must match those in the geochem_file)
! mineral_link      [string]
!                     name of any active variables to be used as a mineral (if present, else '')
! w_gch             [float]
!                     sedimentation rate of chosen particulate phases (m/day)
!-------------------------------------------------------------------------------
&aed_geochemistry
   geochem_file   = '../External/AED/aed_geochem_pars.dat'
   ! dissolved components
   num_components = 10
   dis_components = 'DIC', 'FeII', 'FeIII' ,'Al', 'Cl', 'SO4', 'Na', 'K', 'Mg', 'Ca', 'MnII', 'MnIV'
   component_link = 'CAR_dic','','','','','','','','','','',''
   Fsed_gch       = 0.,0.,0.1,0.1,0.,-1.2,0.,0.,0.,0.,0.,0.2
   !dis_initial    = 0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1
   !speciesOutput  = 'CO2'
   ! mineral components
   num_minerals   = 0
   !#the_minerals   = 'Calcite', 'FeOH3A'
   the_minerals    = 'Calcite','FeOH3A'
   mineral_link    = '','','',''
   w_gch           = 0.,0.,0.,0.
   !simEquilibrate = .false.
   !min_initial    = 0.01,0.01,0.01,0.01
/


!-------------------------------------------------------------------------------
!###############################################################################
! aed_land - AED land/soil model
!-------------------------------------------------------------------------------
! oxy_initial   [float, unit = mmol/m^3]
!                 initial O2 concentration (can be overwritten by GLM or TFV IC)
! Fsed_oxy      [float, unit = mmol/m^2/day]
!                 sediment oxygen demand (unused if Fsed_oxy_variable is active)
! Ksed_oxy      [float, unit = mmol/m^3]
!                 half-saturation concentration of oxygen sediment flux
! theta_sed_oxy [float, unit = - ]
!                 Arrhenius temperature multiplier for sediment oxygen flux
!  Fsed_oxy_variable = Oxygen sedimentation variable link
!                         eg 'aed_sedflux_Fsed_oxy' will use the value supplied
!                          by the aed_sedflux model for Fsed_oxy
!
! NOTE: Processes such as photosynthesis and bacterial respiration from other
!       AED modules should be configured to use the following names:
!        aed_oxygen_oxy
!
! DIAGNOSTICS:
!
!-------------------------------------------------------------------------------
&aed_land
   ! material zones to run the model:
    n_zones = 4
    active_zones = 4,5,6,7
   ! soil depth limits
    minbathy = -2.0     !mAHD
    Dper = 2,2,2,2
   ! soil properties
    Porosity = 0.4,0.35,0.3,0.3
    Density = 1500,1500,1500,1500
    Zcap = 0.1,0.08,0.1,0.1
    Ztrn = 0.1,0.05,0.06,0.06
    fc = 0.1,0.04,0.04,0.08
   ! evaporation parameters
    Zebs = 0.5,0.5,0.4,0.5
    aep = 0.8,0.8,1,1
   ! infiltration parameters
    infil_model = 1
    phi = 0.01,0.01,0.01,0.01
    f0 = 0.1,0.1,0.1,0.1
    fmin = 0.1,0.1,0.1,0.1
    Fmax = 0.1,0.1,0.1,0.1
    regen = 0.1,0.1,0.1,0.1
    decay = 0.1,0.1,0.1,0.1
   ! flow  parameters
    ass = 0.0001,0.0005,0.0005,0.005
    Bss = 2,2,2,2
   ! optional extras
    simTemp = .false.
    simSalt = .false.
    simErosion = .false.
/


!-------------------------------------------------------------------------------
!###############################################################################
! aed_ass - AED acid sulfate soil model
!-------------------------------------------------------------------------------
! oxy_initial   [float, unit = mmol/m^3]
!                 initial O2 concentration (can be overwritten by GLM or TFV IC)
! Fsed_oxy      [float, unit = mmol/m^2/day]
!                 sediment oxygen demand (unused if Fsed_oxy_variable is active)
! Ksed_oxy      [float, unit = mmol/m^3]
!                 half-saturation concentration of oxygen sediment flux
! theta_sed_oxy [float, unit = - ]
!                 Arrhenius temperature multiplier for sediment oxygen flux
!  Fsed_oxy_variable = Oxygen sedimentation variable link
!                         eg 'aed_sedflux_Fsed_oxy' will use the value supplied
!                          by the aed_sedflux model for Fsed_oxy
!
! NOTE: Processes such as photosynthesis and bacterial respiration from other
!       AED modules should be configured to use the following names:
!        aed_oxygen_oxy
!
! DIAGNOSTICS:
!
!-------------------------------------------------------------------------------
&aed_ass
   ! setup
    n_zones = 4
    active_zones = 4,5,6,7
    nlay = 9
    simProfiles = .TRUE.
    zASS = 3,1,1,1
    acid_link = 'GEO_ubalchg'
    so4_link = 'GEO_SO4'
    X_hso4 = 0.25
   ! soil properties
    Porosity = 0.4,0.35,0.3,0.3
    Density = 1500,1500,1500,1500
    pass_0 = 10.,10.,10.,10.
   ! kinetic
    Racid = 0.006,0.011,0.011,0.011
   ! flux coefficients
    flux_bf = 0.0,0,0,0
    flux_rn = 1.0,1,1,1
    flux_rn_max = 0.005,0.005,0.005,0.005
    flux_rw_a = 0.161,0.138,0.138,0.138
    flux_rw_d = 0.01,0.007,0.007,0.007
/


!###############################################################################
! aed_totals
!  TN_vars      = list of variable contributing to total nitrogen
!  TN_varscale  = scaling of TN variables contribution
!  TP_vars      = list of variable contributing to total phosphorus
!  TP_varscale  = scaling of TP variables contribution
!  TOC_vars     = list of variable contributing to total organic carbon
!  TOC_varscale = scaling of TOC variables contribution
!  TSS_vars     = list of variable contributing to total suspended solids
!  TSS_varscale = scaling of TSS variables contribution
!                 <vector same length as TSS names>
!-------------------------------------------------------------------------------
&aed_totals
   TN_vars =  'NIT_nit',
              'NIT_amm',
              'OGM_don',
              'OGM_pon',
              'PHY_grn'
   TN_varscale = 1.0, 1.0, 1.0, 1.0, 0.15
   TP_vars =  'PHS_frp',
              !'PHS_frp_ads',
              'OGM_dop',
              'OGM_pop',
              'PHY_grn'
   TP_varscale = 1.0, 1.0, 1.0, 0.01
   TOC_vars = 'OGM_doc',
              'OGM_poc',
              'PHY_grn'
   TOC_varscale = 1.0, 1.0, 1.0, 1.0
   TSS_vars = 'NCS_ss1',
              'OGM_poc',
              'PHY_grn'
   TSS_varscale = 1,0.1,0.1            !,  <vector same length as TSS names>
   !TSS_varscale = 0.71,0.1,0.1            !,  <vector same length as TSS names>
   Turb_vars = 'NCS_ss1',
               'OGM_poc',
               'PHY_grn' !, .... ! Matt
   Turb_varscale = 1,0.01,0.01
   !TFe_vars =  'NCS_ss1',
   !            'GEO_FeII',
   !            'GEO_FeIII'
   !TFe_varscale = 1.00,1.,1.
   !TAl_vars =  'NCS_ss1',
   !            'GEO_Al',
   !TAl_varscale = 0.4,1.
/


!###############################################################################
! HAB: aed_habitat - AED habitat index models
!
! Refer to the below link for module settings & parameter details:
! http://aquatic.science.uwa.edu.au/research/models/AED/aed_habitat.html
!
!-------------------------------------------------------------------------------
&aed_habitat
    simRuppiaHabitat  = .true.
    simBirdForaging   = .false.
    simBenthicProd    = .false.
    simFishTolerance  = .false.
    simCyanoRisk      = .false.
    simMetalTox       = .false.
      mtox_vars       = 'GEO_Al'
      mtox_lims       = 2.0
    extra_diag        = .true.
/
